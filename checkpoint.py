# This file starts training from a checkpoint. The checkpoint is a single agent that is mutated to get to the population size. The agent is
# then trained with a low mutation rate. For better comments, look at main.py as the files are very similar.
#
# Jacob Karty 12/3/2024

from Pogo import Pogo
import pygame
import pymunk
import pymunk.pygame_util
from NeuralNet import NeuralNetwork
import time
import numpy as np
import matplotlib.pyplot as plt

population_size = 30
mutation_rate = 0.01
elitism = True
annealing = True
annealing_step_size = 0.002
annealing_min = .01
hidden_layers = [20, 20, 20, 20, 20, 20]

"""Initialize the pymunk physics engine"""
pogo = Pogo()
pygame.init()
screen = pygame.display.set_mode((1200, 600))
clock = pygame.time.Clock()
draw_options = pymunk.pygame_util.DrawOptions(screen)

"""Create the neural network population"""
population = []
evaluation = []
agent_distances = []
layers = [12]
for layer in hidden_layers:
    layers.append(layer)
layers.append(5)
for i in range(population_size):
    checkpoint = NeuralNetwork(layers)
    checkpoint.weights = [
            np.asarray([[0.02268812332947587, 0.3552864742077435, -0.40033856912026045, 0.1691244755409243, 0.4716419261755362, -0.6228616244241514, -0.3798549210787218, 0.7006249628118384, -0.2146976033780174, -0.2730113246581843, -0.6168053981628553, -0.093925971781971, -0.35650461106555237, -0.7062202736660962, 0.6698260795888656, -0.7423656102049986, 0.7569326583780099, 0.9099612305487103, 0.8767695634566276, 0.8580252805396408], [0.02986520374543977, 0.12147450213201191, 0.23338007072642578, -0.8372595922168169, -0.7681806540587064, 0.33384263022767674, -0.5027005210374895, 0.29514128253230254, 0.9746076241573005, -0.02122798137398994, 0.13066050599588105, 0.4665652606093052, -0.5140033796808127, 0.7144556450642374, -0.8788044892430986, 0.9270689800252939, -0.03922330546299372, 0.3717655322937468, 0.05884093505506722, -0.129544538524345], [0.6433382339945984, -0.8823797655088812, -0.6363384389885345, -0.6599022520620542, 0.2690922102605066, 0.08203602486788766, -0.9819084668300468, -0.848720490796371, -0.1807723217236381, -0.7309444640174387, 0.5397206065020055, -0.8191356888274649, -0.7958090232573589, -0.1457256782818471, -0.8469166776242395, -0.8051970134010645, -0.9994379063356096, 0.27225243552787304, 0.15164512074137673, -0.9411943485789525], [-0.10401867622957255, 0.6543982176255702, 0.8621917755144317, 0.5723047684371673, 0.5632491590230427, 0.32276593297717404, -0.46064279897764954, -0.6215457651204851, -0.35995969548203766, -0.40393390211574687, 0.5809385632155424, -0.9708987990006298, -0.5034886006516243, -0.43855506826103574, 0.16408342307790502, -0.2699351781020253, 0.21030955875619517, 0.8683104501978534, -0.10782826622412581, 0.45812879324434574], [-0.41465712934382915, 0.9521443415455477, 0.014915912988932113, -0.8392466011691303, 0.8968970486630464, 0.1310641026980236, -0.5282791940885665, 0.19542110915671962, -0.4511510548830807, -0.5511790364223703, 0.6978213988166647, 0.7182735050688055, -0.07901642401234987, -0.3097417148110778, 0.23450002673101336, 0.7217496761651379, -0.8306675609864668, -0.9505282577994523, 0.8712835124368177, 0.6457451038318959], [-0.19279486183213262, 0.4536687270275796, 0.8022294811920138, 0.7457780846256463, 0.9254466261077994, 0.9558963952454804, -0.9573878944161803, -0.722939590380081, -0.5751676100433577, 0.6837573444747015, 0.44327090426505905, 0.7594745370660685, -0.49063060288117866, -0.9122101153617618, -0.27893943442133057, 0.8060367873579286, 0.7649853779630535, -1.0028714494484918, -0.48057112381349965, 0.7076200291147569], [-0.7191512547453289, -0.19549044043988822, -0.28853144180139356, 0.018449655779214404, -0.0020791207254141127, -0.856119818173034, -0.7613358191342717, 0.8127788714653718, 0.47181106719723687, 0.21191083113676737, -0.4002683841602004, 0.6925231201653399, 0.35380646384849834, -0.5833052038917402, 0.656436683001999, -0.23109903969634132, -0.7503240793617403, 0.6022521803191853, -0.501486074474816, 0.9606573939162536], [0.44043101393779266, 0.18218507345185717, -0.025333183444865338, 0.4199270982714794, -0.14309800297706338, 0.4378325673723551, -0.022680769166993273, -0.059339534720475144, -0.2513275301127219, 0.5059542810600732, 0.6046430261683746, -0.2963256653583987, -0.3692419204875852, -0.0840127128008536, 0.5791871683677635, 0.01319764912106458, -0.945544544459227, -0.031434088361327786, 0.8024755372785028, -0.610807418370543], [0.5920439352325594, 0.47166167781791585, -0.6239627021333974, -0.8199773232536474, -0.2714777512896179, -0.8715483831401807, -0.4779229271156729, -0.8196751955618014, -0.3144916525528181, -0.43592476696403876, -0.5508495466669425, -0.8094139932586679, 0.8633932203409024, 0.6930713345738824, 0.591271049170673, 0.3234205080805736, 0.39768101136066547, -0.7620809160109137, -0.2354570437984152, 0.09097012310903739], [0.41410699856722816, -0.2934023770508023, -0.6485608645853264, -0.949616851783963, -0.970153041138718, 0.43800305561665454, 0.7538023286553659, 0.7213405303386645, -0.7089226059406629, -0.9366894978125243, -0.9040575054655221, -0.03664029764238964, 0.5436179505951666, 0.09516311074226053, -0.11452576263595769, -0.7440592475204206, 0.5079747967088971, -0.5242862704546687, 0.5340997921416726, -0.7965977649563263], [0.23027114482232874, -0.35918077452385216, -0.5568385048975458, 0.10211313696340675, -0.43746520983699705, 0.5895597720769022, 0.5032248776368908, 0.48184615732373737, 0.2808285765289431, 0.38433651731719004, -0.10140322921118965, 0.6407594565902358, -0.29751973651203845, 0.442188340692686, 0.7332940165236906, 0.35728548801237975, -0.1167303121480186, 0.9741756426492734, -0.6253885575165111, -0.6918479925016789], [-0.009830485322984597, 0.4840137534363436, 0.0827799600064143, 0.630007993112502, 0.9360455299811772, 0.34851941984724927, 0.8908949174159284, 0.09474419189605361, -0.29761728255193226, -0.0228363635225113, 0.6899838914001387, 0.7323160198900756, -0.9793929584921683, -0.040885232448698475, -0.24078332069037078, -0.6492209269444501, 0.6039403813440777, 0.406142139278157, -0.2869004390937895, -0.6788072950605077]]),
            np.asarray([[-0.07253380397780451, -0.8105007861890337, 0.2179182674609689, 0.821579533283027, -0.6980517259576864, 0.7696737317244339, -0.8217692083545818, 0.5654585957251583, -0.9326327973661589, 0.6406592032191548, 0.6504586489013578, 0.7420331961232297, -0.45626460946159775, -1.0074261575514425, -0.7545334004880503, 0.7752556569280818, -0.14160866146454018, 0.6291833782638457, 0.729148018161365, -0.7553821162146299], [0.19139512579136372, -0.9348953221548092, 0.17175609147677784, -0.6939125144598755, -0.6966233683291357, -0.6287663184478811, 0.6172821165391911, -0.5810785724517882, 0.943301924936431, 0.45078126004840147, -0.9250366220647757, -0.18738410443338865, 0.607783380225227, 0.32750167626390364, -0.958428569450005, 0.9494012943410252, -0.828264164820152, 0.1451263207474433, -0.7582689658647626, 0.46582773662337107], [0.6016627892717334, -0.711769520328186, -0.10079801959905277, 0.28237068042941776, -0.4330010192496338, 0.49136623218231257, 0.5452093744032337, 0.49021897374234014, 0.40915873134232317, -0.9074305728742391, -0.035484156970652145, -0.0381578042206883, -0.2616625707737802, -0.989655368122589, 0.7106652804008171, 0.9397875099301821, 0.1016339093944278, -0.5202804998848162, -0.622135471513751, -0.6323533191617506], [-0.03553930707833661, 0.7722716790799004, 0.6261548401467709, 0.32410721533824016, -0.5957846909662428, 0.9728083156946812, -0.7951174764395862, -0.2912451374950279, 0.2037543699460987, -0.9668077153155559, -0.11953662870652247, 0.8885807460787445, -0.04331742364405646, 0.8863722490977274, 0.5351452926610614, 0.11466038207800412, 0.765110495789335, 0.15090149114880053, -0.6051951750063442, -0.3878675846215209], [-0.9019916313159473, 0.501457097220752, -0.3403472501262387, -0.765437983681572, -0.014317655075844982, 0.523070480875488, 0.9446931924469336, 0.6953505440287016, -0.21394556903743855, 0.013414849210497737, 0.5883211765920873, 0.2889030789487388, -0.967062691113841, 0.8860913466202089, 0.047818742611255904, 0.992606416821194, -0.8257188788397305, 0.1304068959355933, 0.29799068312334764, 0.9083736451799888], [0.1419234891184149, -0.471249401165082, 0.7387141419829159, 0.6477362771583037, -0.013980235998566088, 0.4808644625573351, 0.3465921786450222, -0.16838410214909116, -0.9087170737176917, 0.037586884623899836, 0.21057820687254683, -0.4772506597025426, -0.5168411439952514, 0.4387449085259389, 0.5430034533269442, 0.3149638154000096, -0.5653915711314451, 0.3986188148776127, -0.06327971992947977, -0.4494962070118753], [0.4553002928711117, -0.38065656017460037, -0.7201954346283785, -0.5660979405854628, -0.9497179337507173, 0.0058241339362590724, 0.7764741142947024, -0.8839690736472703, -0.4731271201197934, -0.22219829290105347, 0.9994498292112106, -0.5897273503564752, -0.25763532532901773, -0.7716340489626516, 0.8352147269608067, -0.2732759798957889, 0.988536816056933, -0.5548902468929614, -0.6747424813922321, -0.7798664807379485], [0.3704204684209011, 0.017520854932638646, 0.9571617406050404, -0.8349989379935094, 0.7063022831252846, -0.38028940604010064, -0.9962927620434218, -0.8654049309058899, -0.29508493281532244, 0.09115927678995646, 0.7599101903068801, 0.29571279263682376, -0.01590980154381146, -0.2785553055742024, 0.7323739210925726, -0.43090099124751724, -0.7968288399551559, 0.5796319583388393, -0.6221955336354392, -0.3050300412968293], [0.8541060046999712, -0.15864459249305946, -0.27791546825887176, -0.07541869072963282, -0.6218531146699751, 0.5727531132604765, 0.004229589432138124, 0.05155701667214485, -0.7033105763278515, -0.5095635103534221, -0.4307933997582695, 0.3254410756717365, -0.29183732843943216, -0.34645816328141843, -0.9826726566379448, -0.04675238551636072, -0.8969124237141943, -0.15419424523782255, 0.7496238514728226, 0.5318955474214936], [0.5059026131528859, 0.6089334477720545, 0.4012922921313383, -0.3027841664343825, -0.2866798238592086, -0.6493153874475495, -0.9095412002019178, -0.10811856423366749, -0.7715713991137354, -0.2802133039674416, 0.7591838050449624, 0.8334415585744224, 0.5619319821822137, 0.40217308165473203, 0.7648203490418245, 0.46611362561865893, -0.33080920173369593, 0.7687965502844587, 0.7949957455960484, 0.4601535448613332], [0.8005126064314434, -0.8890682324748785, 0.7498451807006071, -0.22451415372539793, -0.7378956731510917, -0.9631028124624798, 0.3439380923890932, 0.9057328475381637, -0.519985629653088, -0.22590613565636664, -0.5543595475301945, 0.23633933116913508, 0.5129031758386956, 0.2317793832292934, 0.8560851792226658, 0.16216100380674964, -0.850618222273078, 0.5204418583728627, 0.7577182607744564, 0.19835059143746464], [0.34123448569514325, -0.1617060542241675, 0.0882914448785946, -0.33999360284499425, 0.14589633551100328, -0.9170293810399127, -0.24285096951934823, -0.9450389244182613, -0.9027633452670294, 0.7610892741637794, 0.6094302435654615, -0.6051758799131338, -0.4594907465542354, -0.6522633028341036, -0.23652622744415844, 0.32380070372198605, 0.10059210091657068, 0.6884819780513735, 0.9175602620588638, -0.172745211689448], [0.4215197657162375, -0.39230362646836836, 0.6050941212726154, -0.43211561811419147, 0.39552344140797474, 0.778438890394106, 0.240105319783226, -0.9767526654747811, 0.9437584646414677, 0.48546458890352545, 0.5475875489576797, -0.9723369303829101, -0.46255334843432483, 0.39939782097268434, -0.716113377803781, -0.3804453305126667, -0.6006160988865266, 1.0080313729824861, 0.20278315162609872, 0.940784329471155], [-0.25269709103677906, -0.6707527956161364, 0.9639826191103634, -0.3485952910784684, 0.6788077260922554, 0.26637940770717905, 0.5504860402475344, 0.35874307816169615, 0.114727288897609, -0.34708862258744444, 0.35467033091131855, -0.17277068545204816, 0.8390525487114127, -0.5318205547204896, -0.6447115556218699, -0.6695635458641958, 0.1362945066686037, -0.5823587386266756, 0.017979055035727255, 0.6988859982413665], [0.7623896026741119, 0.7494995211331018, 0.4452143509807701, 0.8472944334911624, 0.3630928785954971, 0.023040660529029724, -0.548445642144853, -0.5854825262553454, 0.6315269164178812, -0.6184163955536615, -0.04579699037908144, 0.5011431117829372, -0.38023713674520476, -0.29191543931766, 0.19556382790214727, 0.3938082083246767, 0.7969602566454519, -0.0573581562389198, -0.6663843357069262, 0.7522564311296472], [0.27532492286575394, -1.0159922030753161, -0.20543849200827533, 0.029449139622908505, 0.340046515900881, 0.5808277254246998, -0.8412946339151638, 0.6730031270014284, 0.25532890836858907, -0.21468512787640545, 1.0092503567312174, 0.6056151401218733, -0.35307507968490565, -0.2751458493389545, 0.5093103155216143, 0.8777335084180666, -0.03209180694777578, 0.3900944936940113, 0.14720392807133748, -0.1107971681330306], [-0.3411030332939471, 0.3744419840580875, 0.46542505416996444, 0.6216954223202471, 0.09029621856142604, 0.41948517753459413, -0.3823339623243828, -1.04256648533309, -0.18877394564550784, 0.015444206083605326, -0.5635483834865679, -0.3335624619352222, 0.7075494984318694, -0.03758359077589313, 0.39324989858411596, 0.10660942033367961, 0.4448387658141553, -0.44560872055749856, 0.22812234487993943, 0.08188354860808839], [-0.8786242976520171, -0.45332483330228984, 0.447242945913775, 0.04336603294412345, 0.7488764507843588, 0.6870230325486815, -0.37949566235163257, -0.29864573140098993, 0.30466635270094916, 0.017609989210012205, -0.5750594316118525, -0.8630747933880762, 0.7005686663962196, -0.7544972358221179, 0.894015048948668, -0.12183590399779853, 0.8583151705425882, 0.3781365938437047, 0.5313204169906849, 0.22715764567182006], [0.23307950896536306, -0.028371272501264193, -0.08672486024378674, 0.5335785011978501, 0.4782616970421676, -0.6609758127471157, 0.8786596170910994, 0.998050990204764, 0.10909459030162698, -0.8447739601026873, 0.6234823589570293, -0.5335910277139804, -0.632496018382914, -0.9462415419154037, -0.46560829162995615, -0.26526042091299007, -0.05463958626751979, -0.49238305474314964, 0.9630005986606407, 0.14705378205718753], [0.13955876275312726, 0.32636069091112746, 0.5384435919287829, -0.9175952753755255, 0.31100595426446825, -0.6037017870655804, -0.2412800656222538, 0.562147400155448, 0.2557792136395496, 0.11654034890306388, 0.49130214764449853, -0.27487864674574713, 0.9161423903644607, -0.3510699871710556, 0.9894619209031963, -0.23928009791262117, -0.2645499041886559, 0.27064818064985247, 0.12802536157092964, -0.5500513320044751]]),
            np.asarray([[-0.6113578319191233, -1.0288937149433417, -0.28086324597304557, 0.36177639334852707, -0.4507915402802208, 0.4099793807602903, -0.40235818233678206, -0.3929781649835742, 0.638544989723659, 0.6900700702437994, -0.41226309862358834, 0.33154761639477137, 0.7050955323317036, 0.5344166627761326, 0.7693212422363006, -0.8854822156626678, -0.8520761025849675, -0.35462402045874863, -0.08019080439144588, -0.3786950878945641], [-0.918100828892241, 0.1997279778110646, 0.3876779806578249, -0.07570008922585646, -0.00958626102503654, -0.27663982349556354, -0.6555974867109582, 0.8510508796047181, 0.8025123735205008, -0.3150611257421672, -0.20861747440958436, -0.8808221777353868, 0.46117354535402283, -0.48842166385956687, -0.15822609541607635, -0.6992031029615252, 0.40225733527019997, -0.2152404439234298, 1.01217655980361, 0.703337758940748], [-0.10775478096969583, -0.5604822638161449, 0.7051048901705479, -0.4930021498434313, -0.445907152209077, 0.8220623821249167, 0.6082005240067554, -0.6354124881140631, 0.9731565313081755, -0.9766438206861863, -0.5045906142019975, 0.10329086375857678, 0.6887873310688433, 0.5113925178738975, -0.21770201452976662, 0.9034722996232089, 0.9309661034803575, 0.11839436846755534, 0.29657260751812126, -0.04687408849729773], [0.032025465552517854, 0.7882929541041421, 0.09041612026468393, 0.4765267709555192, -0.980771618953813, 0.04862632920915234, -0.571015643723239, 0.16637836134982925, 0.09195582465091118, -0.8702899670512183, 0.2498787942928874, -0.2051751908463718, 0.9664680649361811, -0.8752100272764846, -0.6675345389632098, -0.02556508565264982, -0.791711070935002, 0.5853456088941815, -0.020773735035413937, 0.05711009174397634], [-0.7698631485434269, -0.29152372033977, 0.5587330274713256, 0.1914365485781069, 0.0533589248423177, 0.9794719167961274, -0.32400707348268243, -0.18556502761218258, -0.48391241409877916, 0.5824953175344907, 0.465403442178647, -0.5732034160812557, 0.9683586719629872, -0.40797499782714447, 0.14040277433024376, 0.8672713223503363, 0.7852387198207911, -0.8100223910566744, 0.4700189976805587, 0.8657001176532251], [-0.78495512689931, -0.7303213805642518, -0.2843095692524703, -0.2464014280256778, -0.2808547227716403, -0.6540752350312774, 0.5950100578558687, 0.31742156937215876, 0.8336782122660584, -0.9570306046572816, -0.8654722644641497, -0.6888647055577987, -0.3916712392487138, -0.970918146432723, 0.3481982039292948, -0.45693176920317774, 0.4440507118965089, 0.9447697423966204, -0.07680828789368692, 0.11088932269734131], [-0.9461444841239076, 0.5273906668441009, 0.2982371937645477, -0.002079723755248425, 0.8893980770453683, 0.17990211549515853, 0.8712956358635373, 0.0766602158094405, 0.25915876118227116, -0.2148087835450374, 0.9878146592744913, 0.971997246277656, -0.6878738887384953, 0.6665633027057458, 0.4169977857601145, 0.4563334642495622, -0.7421341409124672, -0.6896570348231156, 0.5647842214673112, -0.21531373970448853], [-0.4122720800429547, 0.9814857992125146, 0.9477757022351799, 0.9697265193160212, -0.35637686708973354, 0.9377502677808441, -0.309098927393544, -0.18316215802066782, -0.1511938009461158, 0.5559964762151266, -0.46364284380961385, -0.4192582040966212, 0.20827887476381057, 0.42803358091963367, 0.7550789802843973, -0.741996260549434, -0.7552699816015249, -0.926426852539558, -0.39794141345669404, 0.5057627297789437], [0.9333798459640846, -0.8788671448633729, 0.7085371293445798, 0.10171493014115089, 0.395987996705401, -0.050502497256860915, -0.27543530753401896, 0.8698846852697651, 0.9409391247356097, 0.46200751368204046, -0.21142297510169406, -0.6761222808539455, -0.448697140465081, 0.5673357353621681, 0.2768026207280833, -0.9723331058184274, -0.2253205716917363, -0.40642349863188915, -0.6355803778123857, -0.5726938389521639], [0.8001896411494642, -0.08555283401650741, 0.1598297174468011, -0.2736219269719915, -0.3967759943706912, 0.5831581855576815, -0.5446496455043084, -0.5861057535821564, -0.6955952883740618, 0.7531148450704717, -0.6187168268546714, -0.44540667665366884, 0.6527110741187285, -0.15463139610847138, -0.27666134395691644, 0.04390987136423373, -0.866317605988318, -0.8716906200746062, 0.5750856635615424, -0.32531130838324296], [-0.378849105169604, 0.8670204629720357, -0.736494788029997, 0.3620227520225916, 0.5727220124545198, 0.018635106566458115, 0.49464692273191324, -0.4087361818437093, 0.5621963572942756, -0.6693584034913777, -0.282592789251763, -0.2317018258299659, -0.9080107054369299, -0.42698035260447925, -0.15068681618923005, 0.7842298051444907, -0.6710984702556196, 0.007188251359580455, 0.8087098369963838, -0.8891302574352115], [0.7593792093540892, -0.7845436929277904, 0.1366477258468268, 0.762544599403345, 0.9809991224638598, 0.6008651014849833, -0.5669362077543708, 0.9751568433514536, -0.306642079989925, -0.8794838811421074, -0.8520937647769636, 0.46585831716302206, -0.6107446870303095, -0.23985602147515578, -0.14913087373886036, 0.5145916139364691, -0.8090569911464129, 0.9500460449698477, 0.8645288098368169, 0.8760122668648539], [-0.7180250197506581, -0.7348872703267425, 0.12153307234247399, -0.13248256574910527, 0.3698897782779552, 0.5971491324682091, -0.5697759377164472, 0.16309405723255366, 0.9515295894156369, -0.3594566808814776, -0.9700749104214953, 0.777077565383714, 0.08053909712729855, -0.4316470953770392, 0.23984244808243904, 0.14616407941367754, 0.1971808599005157, 0.2551686829425026, 0.9065682643048103, -0.6096721102209942], [-0.9352885258241146, -0.14371593219523623, -0.7163817983849574, -0.672360136531315, -0.5662845855479235, -0.3624288612862413, -0.9537785820488951, -0.3028234533239468, -0.38825848125914936, -0.6662094142487109, 0.3650775248465847, -0.9588943648111149, 1.0092039907529102, -0.4748288172190802, -0.5607458596111139, 0.5156288221836342, 0.9279819653164847, 0.8145013432413367, 0.8948954094892179, 0.9348474080793301], [0.8922575870241232, -0.5057600043753618, 0.26118835902712806, 0.7656574678280786, -0.16112430376899375, -0.5577018217112246, -0.5779352924719583, -0.6678719377160096, 0.024603393395639366, 0.7464040750268328, 0.5677612226786902, -0.6073623132570658, -0.19159392462063501, 0.5023346678319094, -0.4977866487507157, 0.5135558574314251, -0.23296262251896555, -0.9706269093204888, -0.7568397368809135, -0.6985816541567418], [0.7770930833126103, 0.8757801938839943, -0.0007579848086004121, -0.536743454721337, 0.0003900466849049485, -0.26775951518735486, -0.17744654064106818, 0.35616462846919156, 0.9259348534242829, -0.48115451755057126, 0.792392227143719, -0.5229356652203498, 0.6417550536647674, 0.9616273032339676, -0.3819390968089385, 0.8501283448163565, -0.8493404513423877, 0.6606263331470007, 0.3138791254970087, -0.190901836635415], [-0.40297346041154686, 0.8088996478933381, -0.8862529668490641, 0.9667881946644887, -0.7595284203622413, -0.12115076176379785, 0.8658873433336868, -0.5401846214058557, 0.6888331522606341, 0.5658801421162932, 0.059661524626829054, -0.3860539027565016, -0.6306762373391646, -0.24040654926407942, 0.6180101756562401, 0.3483237368354989, 0.4261980561352173, 0.39041054562468697, 0.08199325120056904, -0.9844823436693488], [-0.7607618909247795, 0.814288085375282, 0.8484836523531922, -0.27668734886488555, 0.8243235508574293, -0.7590210116260951, -0.8647567062206116, -0.46637431201327734, -0.7359480649094642, 0.7000114319505655, -0.8366381764064844, -0.13838675885475477, 0.40966143235536945, -0.33897341332162995, 0.23709439077667005, 0.006181365791026781, -0.8765652768256196, -0.23949679089192696, 0.930521800232373, -0.2861378907755289], [-0.7740347510529088, -0.2689114517588608, 0.2975704119279045, -0.40516531193378436, 0.1685762609508661, 0.4950220154824807, 0.45149254446368325, 0.19776659542465, -0.7598344626266675, 0.4723123689139658, 0.4237672699619336, 0.3174472622210746, 0.8869604237452776, 0.013854159692896714, 0.31790947315080864, -0.7511282032953874, 0.1050685887661154, -0.6243625991523569, 0.3121271675389096, -0.11003919112994431], [-0.7918478858646323, 0.7836070706359055, -0.05069339336766698, -0.7879959335391156, -0.4668472142238322, 0.39361509437786085, 0.5691917609874939, 0.7421015245580215, 0.3613841920292868, -0.49209043251014456, -0.6157105652345739, -0.005376232956056423, -0.13863793791235113, 0.17696926684308964, 0.131157377059183, 0.408605195927769, -0.7345848644819897, 0.31004829189050453, 0.6215631695656723, 0.3488682002259907]]),
            np.asarray([[-0.7602266064297519, 0.6863678519379504, 0.0915503687922371, -0.0933824182136076, 0.9273334459085285, -0.683432479324317, 0.1380340131796508, 0.4167341281272789, -0.5402476468990843, -0.7537798059688762, -0.3575839912442794, -0.016138280999572287, -0.10515891846234628, -0.7005882197566586, 0.4882005594670148, -0.08540475941150238, -0.9722583032120774, 0.9295237082492196, -0.5026800523723627, -0.4822707869111905], [-0.6017542133797845, -0.05967558617556867, 0.20584464230777344, 0.7868555370900117, 0.10541651420350544, -0.6796637479047047, 0.4695970431466703, -0.8477030071853977, 0.6903371121440826, 0.5802083274150327, -0.9144746878695457, 0.11765135454497504, 0.4903567241503048, 0.49256739807918165, 0.7448878381000502, -0.5188095037376622, 0.1252828906908493, 0.8553650522379336, -0.9963184036592292, -0.1457694411266206], [-0.5600215478601459, 0.4917053464841397, 0.6010919690860989, -0.9181481724542878, -0.40307343890087544, -0.48029010976881986, 0.5214285794197809, 0.83271072916568, 0.811952963040914, 0.17609190189433155, 0.005576542784319812, 0.9593259607919007, 0.020348945934001807, 0.036845401476099424, 0.8530623681769313, 0.12576228337100478, -0.09379238983027127, 0.46248146573055193, 0.4141554404315006, -0.05544205786715291], [-0.8899040732906818, 0.18731345345012024, -0.9873144438632616, -0.4559975095614256, -0.6192556257473752, 0.49245904576245064, -0.8350254582087938, 0.24086572079031385, -0.09478767159036028, 0.6271948553963057, 0.14558891229280246, -0.04202669027018641, 0.020387976877029194, -0.9381496970526952, -0.9703152699899981, 0.8609897520665304, 0.945094468581715, 0.2027092755891808, -0.8650671082309831, -0.9882817314060449], [-0.045579327951776, -0.4782738555749159, 0.8031801426013806, 0.16102490989027002, -0.6267335624018799, 0.7278821708122304, 0.19898202378053323, 0.6135122133755507, 0.5090344733594518, 0.1981400026495359, -0.7384788864672637, -0.7472428847194967, -0.9358733303280556, -0.6666345924713271, -0.7658098193124248, -0.5121733791647907, -0.7473046415003294, -0.06635594518705941, 0.2849050138071198, -0.8274801817907198], [-0.6067924208228013, 0.34969670049898927, 0.06326243241369978, 0.6424770243749053, 0.8662871396276757, 0.2971014566641831, -0.7700007769535747, 0.9513831909666753, 0.27167169855699846, -0.6238717951250013, 0.6162612448986926, 0.8954347152758488, -0.5736242939866225, 0.7524909694113093, 0.39170359948718164, 0.17967876572855637, -0.9485298389514834, 0.03207762014000764, -0.5658182075209836, -0.6831494742992146], [0.9673528161809288, 0.7697521877583324, 0.3038081115147663, -0.8109518036512886, 0.20757806147741126, -0.020297858578209822, 0.939562298130413, -0.03736767996313417, 0.17414040827059593, -0.3759341579226342, 0.3448737829413551, 0.3727059165246407, -0.031556244659086075, 0.07860573220763722, -0.574658750187866, -0.14834808006582914, 0.7867115471280147, -0.8426852039944768, 0.5017878249819251, -0.31920063271020765], [-0.5730173916130078, -0.8836747947256778, -0.3910879495239803, -0.8948666021826811, 0.16792145152151194, -0.29899307538900377, 0.19595781626062947, 0.20841038924720606, -0.04257201495954952, 0.42368573512942487, -0.3282855661713553, -0.986715070463741, 0.8720928373658193, 0.8504279646793431, -0.9016523847087156, 0.01868523375082569, -0.06908414902056426, -0.6104553309550003, -0.9747549901560645, 0.9419332856672955], [0.9653406334290684, 0.4397316788812014, -0.5524353091448314, -0.17579756359617688, -0.3317565356589588, -0.3619286663646855, -0.05368602417580395, 0.21622661735633458, 0.6118597328765204, -0.8616077207160372, -0.4075747691270482, 0.6571319845373002, 0.607367742517034, -0.6332094680064616, -0.9339234655029645, -0.7680994298517414, -0.557741397054591, 0.59810873732151, -0.12253983846519367, 0.0009766460080307638], [0.07085822482389735, -0.8754904610326256, 0.11363081050883604, 0.2785697340773135, 0.18979138455327937, -0.1767107869399952, 0.699113069924, -0.7816052736147436, -0.1189658037527444, 0.5980532392484735, 0.08784777846613438, 0.5392123425624293, -0.747050301872423, 0.5775304260471346, 0.3818258395168397, 0.3789325088280303, -0.1035921903104399, -0.2459841849920551, -0.2900765220811508, 0.9651775743233626], [-0.8828026563759785, 0.5676641499440968, -0.8359085607278759, -0.1498121099246212, -0.849290903536074, -0.835768199916859, 0.4269852002669968, 0.11065202182788886, -0.6255878467951774, 0.8322738266212755, -0.824896499233602, 0.1876485185302423, 0.8628132464913001, 0.0038217363109951047, -0.007467884167631224, 0.4535799233336637, -0.6816016528331365, -0.8250296681553528, 0.3394941823461737, -0.7169709597881271], [0.9504581492098634, 0.26552961478341025, 0.6925979714492955, 0.8749168175667685, 0.33721842968369437, -0.699765984135528, -0.23723887386223333, 0.08315385125260222, 0.539599686039801, 0.34801843851447856, -0.1249206051092839, 0.6627398319004536, 0.6012471835252088, -0.6368924177162401, -0.22948818109644933, 0.6349383353648721, 0.745583996224379, 0.4985634861616652, -0.17434828191967433, 0.030483514471938863], [-0.37728712285870836, -0.860490576267288, -0.41980347305183047, -0.1400504557944291, -0.04878091800528838, 0.6797413193745252, -0.04428378418626692, -0.10441616456179043, 0.23767139257957842, -0.48601784006705395, -0.1656216376151045, 0.8718450282841389, 0.4621359778926295, 0.17143884942702423, -0.43152797047424757, 0.14320737693044436, 0.5629253567723465, -0.917913437162533, -0.542828152808407, 0.2203776680802189], [-0.3960201770529875, -0.6510035372714132, 0.2613234830907089, 0.5155089063889368, 0.12015275546501206, 0.4294059275198051, -0.8198996110821974, -0.5844923632110961, 0.8917010926740018, -0.15238281419591215, 0.15175938694530738, -0.5841603554727955, 0.3564285442319559, -0.2271340453391046, 0.5243520796583171, 0.07750596598178007, -0.05765829316405407, -0.9058508156162222, 0.7407221431393098, -0.902518680233719], [-0.7695254083974175, 0.8265767440461783, -0.9046283250084991, -0.44268143328055415, 0.8207350538212533, 0.7227619044423766, -0.5992324465112926, -0.3046523261663633, 0.8696058237314593, -0.6888850384473307, 0.534083563465431, 0.6382987180212458, 0.7384500282102061, 0.39779451086516704, -0.00021013281094085443, 0.0420436647605364, -0.8302826890473071, 0.15341361091693734, 0.39033754356384515, -0.007574948124075109], [0.8001316535678494, -0.6753525338717902, -0.5824639645456162, 0.3133396999559034, -0.08248103370763171, 0.1471047578241171, 0.515038564867382, -0.8518762187002584, -0.09707600628194853, 0.7824902014065934, -0.49393209696327184, -0.8927433486124968, -0.29401797726775497, -0.3332128429491522, 0.3266634731539376, 0.573613500490177, 0.7921880253340526, -0.42380269277754734, -0.32141774650271915, -0.7173461573902444], [-0.08125381598461402, -0.46111132649974196, 0.5527991118302396, 0.2798522167546399, 0.5017720680925625, 0.4557081312493052, -0.9522966899156603, 0.34409283742252655, 0.17307716081916638, 0.26637916140671936, 0.530296509680647, -0.36131540169547866, 0.9119765846529442, 0.13426122830178305, 0.7636107714696637, -0.9150273455343196, 0.4316331572174307, -0.6748474179907865, 0.8946841403643402, 0.20133422679777888], [-0.42652215198583837, -0.24224908236037457, -1.0139910432094452, 0.9599893959830187, 0.4159002371078811, -0.48288907893903193, 0.7085477710785563, 0.6386085666407081, 0.9003449586054588, 0.04051189829043831, -0.5736755208712158, -0.09551124780417858, 0.04807929284950851, -0.2649551125422109, 0.42532693107775293, -0.7564966600975213, 0.17134290682175735, 0.47578211731649406, 0.49002375439373336, 0.08053538237458349], [-0.5423458356073384, -0.5903766947543637, -0.8501769219988624, -0.7637471076158477, 0.354378073462308, 0.526825459785218, 0.5321920617193419, 0.05680623182219962, 0.5219794585380871, 0.3803928295870103, 0.21874034233850964, -0.8745119747437062, -0.9760606755178269, 0.9744059279693525, 0.3381155400614615, 0.01039716032576539, 0.7892428081909182, 0.261716257419656, -0.29073182763599426, -0.06686347156996407], [0.920674275261085, 0.35317333135073714, 0.266888285125512, -0.2947964211516581, 0.3874019405031788, 0.424511551708455, 0.349907360168073, 0.5141171161057675, -0.5357973894883192, 0.4159252715773176, 0.20630718573432857, -0.5771907654342507, 0.995741694458235, -0.3192906615356169, 0.8448381340665814, 0.7966109086961103, -0.30227873594668137, -0.517358242254324, 0.8453473026332944, 0.30715209157441165]]),
            np.asarray([[0.578878035009297, 0.5615959520383116, 0.03319292765940267, -0.5047356498994995, 0.18409908074323367, 0.8730851731493156, -0.8662818259580625, -0.09734210431636166, 0.9928346366416846, 0.3492740482136858, -0.8041022183328648, -0.688203430766319, 0.9197695519258997, 0.5874653280542028, 0.040447484382628546, -0.7252038605272475, -0.7379511241569444, -0.30014612045107086, 0.06362041318901085, -0.4552309569967045], [-0.6050295345594686, -0.4320753716463595, -0.2548558754037955, -0.2623996145257403, -0.5307363646259184, 0.39669265165161205, -0.5302469777818174, 0.19310378752319957, 0.47092662444464056, 0.14981550984988637, 0.24097889674337833, -0.21309884687887617, 0.11408323727963436, 0.7372245329535212, -0.9966237121405521, 0.7142491069027204, 0.9859789372146496, 0.713520401088096, -0.05323304594922954, 0.7436035344519816], [0.800388985203828, -0.3728460552167015, 0.7830185616095958, 0.12983598620630243, -0.44297836897657356, -0.4801185940760922, 1.004224948308802, -0.5428069180054453, -0.054657700132531184, -0.8273040553629144, -0.47539731587936374, 0.8990686896259279, -0.8995490393978507, 0.13753350293643885, 0.4788356338796935, 0.8664847940569653, -0.1138278561556105, 0.34575970240820963, -0.4092485477239969, 0.5679753177401404], [0.07412408843281493, 0.8455694308705345, 0.13574145879940547, -0.49069040548264475, -0.6016511993709243, -0.6505485347763539, 0.14295068355717733, -0.2508952725698314, -0.11207496581051231, -0.7329326238580058, -0.3105839660929992, 0.9245488140017641, -0.03760967940969463, -0.7071274580133009, -0.583561913843712, -0.5238095684294439, 0.16029324979421178, 0.03537046793636844, -0.7781449406580093, 0.34598311501020756], [0.6659479221273422, -0.9038814414636201, 0.011131218984335535, -0.9831710108483854, -0.8352083089180488, -0.404923253775498, -0.7662007620257874, 0.198422580109765, 0.19958324864922697, 0.6009854565659447, 0.10530451403848891, -0.9122830434306616, 0.24250106817395256, 0.5498030460126277, -0.32823426010808127, 0.22334666817351037, 0.6494114445369417, -0.9301149030481626, 0.2590818124789676, -0.4540722824295472], [-0.3086426540994373, -0.5813851820905273, 0.4372111564587169, 0.7459459437176341, 0.3749409993548555, -0.8218672298318497, 0.9525583652496981, -0.759733768007045, 0.8494926099745347, -0.52461135027845, -0.8779749745359655, -0.3070133485435426, -0.3397834940566026, -0.1278429621996354, 0.8714538673882887, 0.11671388909497024, 0.690610154409852, 0.5694855288876282, 0.19589317048497334, -0.5959689874430172], [-0.7759947444522909, 0.03269754073676604, -0.3982915308887031, 0.8492969571557166, 0.3437250998634339, -0.5711560296050473, -0.2562705837796635, -0.7995322132598267, -0.34047394635330885, -0.8869028077836517, -0.395383419416183, 0.6044668431263882, 0.3059579429305329, -0.6486763060388551, -0.5336423285105696, 0.2192454785244985, -0.08892944342986678, -0.29279488629485173, -0.6613178571390145, -0.32836574149133324], [0.9814466808314505, 0.5147164386077306, -0.2807278010242377, 0.5283244585624935, 0.8599156124823353, -0.4630607589953426, -0.41621003776484594, 0.5155600039879438, 0.7830587155030433, 0.8622558321840957, -0.7497420581531131, 0.29030220105716154, -0.758183904686915, 0.8619226981086219, -0.7311179850349857, -0.35701967243492905, 0.009563540265199875, -0.8119378727886725, 0.3222686154061009, 0.7756981989914078], [-0.5745915213219346, -0.24477982549785804, 0.6260273076782078, 0.73076896807256, 0.7887994418848037, 0.4813134223389969, 0.40565339734642925, 0.04308485269182124, -0.09591476177395654, 0.7455011707414367, -0.2255729186050938, 0.7247627764099183, 0.6706281845891258, -0.5032893221610043, -0.9579605156790201, -0.6379072157527054, -0.8314381511692264, -0.36540708059751703, -0.09985398076670066, -0.6947126856025775], [0.9623045393235954, 0.6565008003800765, -0.0032742652935482492, -0.6243821416505906, 0.7641900380440674, -0.6149086630487962, 0.8755455895835861, 0.8052066960948038, 0.7652819424927728, 0.6507005015858521, -0.10498942629422248, 0.577979771808116, 0.30733141214364057, 0.55752451829595, 0.7624275081067513, 0.5020669058205618, -0.5465442644598636, 0.28652031019655505, 0.4529527755302339, 0.9663434263714802], [-0.7963025085116349, -0.7843830208449759, -0.2908882042743911, -0.3629508479995735, -0.5071093505388662, 0.5485740079110661, -0.4569406525975967, 0.6289564806458119, 0.13826015051714963, -0.07066815693883575, -0.8050184469001582, 0.954680342586878, 0.2977038589013181, -0.22142320051740202, 0.07539921982931228, -0.06339447327708872, -0.3906313593021845, 0.888976447935714, -0.9493210833353465, -0.027227522395284864], [-0.44577091266245433, 0.3350972989132605, 0.9001827530530773, 0.18201674689781264, 0.705252054425109, 0.533830832054417, -0.4236732426727672, -0.5200062794338135, -0.9172441319244267, 0.3852968842173443, 0.6844608934801916, 0.19272304464978163, -0.26570630834373743, -0.2492383042571475, -0.3424829589641487, -0.29875706148240233, 0.05746763039645366, -0.21262936009925568, -0.4826799946590984, 0.1058143093743961], [0.6527632879228735, 0.6941582155834435, -0.0289106765969512, -0.7380611920034366, 0.2924961624760695, 0.5783604686149086, -0.7061323524873707, 0.16004127973656113, 0.04683641067491133, -0.5292428401171191, -0.2691944052547075, 0.8201408163181961, 0.02918677225700116, -0.8119234200200929, -0.5461669390840955, -0.9615183292118493, 0.013848205067163291, 0.25498284573035335, -0.9654980062127122, 0.581109986083488], [-0.08267997532957505, 0.24955773450991708, -0.9766040712822576, -0.9235859048422616, 0.6952665922821389, 0.057417959985187665, 0.7925425065334281, -0.41749875212680976, 0.12350008595411238, -0.6164662645700558, 0.12589072079960045, -0.22369380338019107, 0.07713684274835934, -0.0006076141297291946, -0.3136965076326955, 0.47000665309310413, -0.4473188269393864, 0.2255668025071909, 0.8689075856317527, 0.4875868518307525], [-0.029486987625874157, 0.6672920975726819, -0.6158139396317037, 0.5284454087013392, -0.2370457438519299, -0.39340254024092836, 0.17970075956320292, 0.9762495705578947, 0.10883079659858239, 1.0120618048432253, -0.5100425950548325, 0.8950696384270395, -0.3699391705027353, -0.9326786622177174, 0.1507476033417109, 0.9174588921256325, -0.5371878048207125, -0.8453662965948264, -0.9142052226343493, -0.44277532328280406], [0.14083319876763117, 0.12698012103800016, 0.1773205547442778, 0.03155531155907698, 0.3001265800081241, -0.6485904481743493, -0.6321276884758781, -0.08187774595575702, 0.1800149092593325, -0.8103124573370734, 0.46519240429507763, -0.8602415247740651, 0.8956973499374465, -0.7496629579323904, -0.51849859934574, -0.40158115437606284, 0.43403660980794884, -0.7990834359800505, 0.6322209808610084, 0.8403966889327031], [-0.9388918795335099, -0.5077461706074105, -0.6861939657628264, 0.026897479632099694, -0.3686328701542481, -0.7138885190857555, -0.43016945140088775, 0.13728239641087284, -0.6967216138971163, -0.8456717713027926, 0.00022595569841203644, 0.359409422492816, 0.030704902856444376, 0.66881534917813, -0.8990192010263487, 0.24621382068487985, 0.2768181572675447, -0.9614537069602028, 0.5623205128346187, -0.10503945205958495], [-0.6375978048686715, -0.7454562186473247, -0.044557060867826105, 0.19820034799472225, -0.1806460101304339, -0.1929854481520304, 0.48470359591978285, -0.0969836965266746, 0.783225892765501, -0.4992967221072488, 0.8517214863687294, -0.5534974516428646, -0.03943862282470994, -0.5029472309756163, 0.637905872917018, -0.7048434217248373, 0.7633381207633211, -0.19453569509358634, -0.9088249650674093, 0.9176977861570705], [-0.7732015850139694, -0.7825633556845593, 0.8436109222726803, 0.3983253586904199, 0.8896076263499432, 0.394865422812006, -0.5540625140383181, 0.7019591137511304, 0.22726855674329421, 0.9389587625130378, -0.8841937871523841, 0.5804108828806492, 0.20116828441720533, -0.2721993151033275, -0.26818115211668764, 0.17093936966785972, -0.7399583248690155, 0.3649637246066975, 0.3082721720323053, 0.8022502123859895], [0.7450544878639785, -0.40056983020666964, 0.4085015075786945, -0.6510279464988072, -0.6038592557212286, 0.7295787252057219, 0.13707741726331468, -0.9420077366051272, 0.2418477874432814, -0.18939836531376872, -0.18498414297322605, -0.9473959543928497, -0.039429641446584535, 0.8668730621706042, -0.6062403926808818, 0.23495689608769837, -0.3056320108821634, 0.49225572259005906, 0.30896328785079524, -0.014282677898421942]]),
            np.asarray([[0.6073740468149563, -0.6686356032157839, 0.06157328666289639, 0.885152596799344, 0.5397944230543142, 0.5695456148089361, -0.5442734867322484, 0.27817068177663473, -0.689914716432564, -0.4175423320659466, -0.05624038559785778, 0.9830672116610796, -0.33652711694879933, -1.0014102213741949, 0.7521952241900206, 0.203940745787678, 0.4092144826264852, 0.4745740913592271, -0.5146665138050125, 0.6740576137448199], [0.11682776455941431, 0.7143651160708375, -0.6657170835366375, 0.41539467385460926, 0.3587167013740282, -0.8087057425107214, -0.18632279362189294, 0.029230378383467478, 0.3214906236470907, 0.7931371442463334, 0.4369265232150383, 0.310397094339498, -0.979167010536614, -0.14801432532760694, 0.8308028330855066, 0.3581404801011748, 0.5233344131268503, 0.33948562291499157, -0.965171791629549, 0.05663774676379098], [0.8622594424159286, -0.5451915381173361, -0.6382570421912479, -0.7269350433202034, 0.604490290336748, -0.5866188820171352, -0.3815637737652523, -0.965056200719848, 0.9615657369395105, 0.8870751523430513, 0.9171434992954193, 0.45990059905967506, -0.47896509226682316, 0.1023635455122419, 0.9095436002653459, 0.024719793586223046, -0.7761922477593565, -0.6336859377583032, 0.08772467025342603, 0.6961258216871582], [-0.3733856626626726, -0.7238975460763681, -0.08103194911372344, 0.5395880487286073, 0.3107370367090069, 0.1998597206178428, -0.05667580980643594, 0.614595255078315, -0.010732287431207254, -0.680621697269579, -0.23471758091145034, -0.6318830063422968, 0.4455558593467113, 1.0006018001996495, -0.5736779163666732, -0.7011259890301953, 0.5056770539609539, -0.3478069449984541, -0.009653487497462202, -0.7612272362194918], [0.6801670697660618, 0.029170926147274626, 0.6633034520566155, -0.42242232479879643, -0.4284197664649216, -0.6977815204586276, -0.18668198407695874, -0.6974691826743745, -0.2797275970196478, -0.633279127891524, 0.08973004113640928, 0.33556873574641494, -0.3861434515078546, -0.8464106785586282, 0.0997984893275822, 0.2026243895476717, 0.26100018537059094, -0.16550821564078433, -0.06781691289205967, 0.8123869562790788], [0.6162553700773017, -0.26550143166572926, 0.9602220619375385, 0.6496771408030547, -0.8923705193385161, 0.6930026919140025, 0.41474160158857726, -0.1327603588546025, -0.1774749910965385, 0.3828086129266931, -0.870533942210702, -0.7068367854837507, -0.3814914255489215, 0.49931720011621805, -0.3611258214580443, 0.9544709000870133, -0.14779298956308914, -0.0727677665799823, -0.8136629156222449, -0.9602018586693281], [-0.541931280609363, 0.7212587888626121, -0.32592943637818156, -0.5983735431751782, 0.9931983829455983, 0.5834982148804637, -0.6787494756542187, 1.0124295436266972, -0.4785655549307991, -0.5245276813508039, -0.2266598970378498, 0.20980919099881737, -0.8027173054885487, -0.36611531447828377, 0.9898829306346884, 0.5051765743557461, -0.4247355721581919, 0.09527457522419629, 0.7937786931935933, -0.9530279318640539], [0.5209654959660068, -0.5944389565392421, 0.21463133103619184, -0.6469784414592527, 0.6502637695950557, 0.028925467119489973, 0.12561599932709278, 0.7317497779796247, 0.9171992263378734, -0.6518323700975036, -0.9307028337002634, 0.46869355234177906, -0.8003564401098177, 0.3384049146228441, 0.6127007183493396, -0.20996690725971284, -0.6052026613344759, 0.6246745876164608, -0.8454500450184045, -0.013151174359423638], [-0.07349275742939172, -0.4307194030546212, 0.38708587204679584, -0.11384138110393814, 0.35967623289691314, -0.7992635812269583, -0.872534348480914, -0.5886604524104752, 0.8032484180024382, 0.033654819158171145, -0.06422354312273101, -0.25970619233607883, 0.0010730997396031445, -0.37473179299534626, 0.2331306871314362, -0.45820454364829083, -0.3508124347057536, 0.4143679556204891, -0.4721657768311457, -0.7918847931390476], [-0.20796627753643682, 0.35802198511747607, 0.11868438561476932, 0.4887700780190814, -0.736622885909457, 0.10196644162432628, 0.16996861612823322, 0.1137650588113748, -0.4027809613438768, 0.1250283396270475, 0.032629823896644775, -0.10481025577588172, -0.6091962910200098, 0.9011325251884703, 0.6080838388523286, -0.4394431969701868, -0.9534044277913551, -0.133229108409637, -0.9048999018483792, 0.38296882097497154], [0.7442827353918078, 0.7083391666777686, -0.9461108884747709, -0.33991763816830156, 0.8339225313508366, -0.5932809199902427, 0.5780806909889364, 0.33658174018207343, 0.04960328339483629, -0.8540789842785758, -0.152144415222215, -0.193683239626726, 0.8618950083986014, 0.16002090870077043, -0.33712939845900713, -0.40390723734944084, -0.5417272382924806, -0.15702534518091968, 0.6420964901482147, -0.2643854124382081], [0.9836958148814019, -0.46837163763729234, 0.8793102972563774, 0.8869252082319486, -0.3323167058701133, 0.8400368440767529, 0.42848782108853695, 0.37923808707340584, -0.32162634763334264, 0.1694379545751897, 0.6816988962697158, -0.35893328562820104, -0.899876224855278, -0.397750588169858, -0.2011563600203665, 0.32408612631378336, -0.007391348268651257, -0.03012294051976096, 0.30094649319725997, -0.473014460276227], [-0.7203861287553938, 0.34617853459055564, -0.06489016784581564, 0.8757353943432661, -0.36870178561534567, 0.8007231334928202, -0.8303170512703801, -0.41284426034215077, -0.6519895012603671, 0.0035658894093550803, -0.7505951816362736, 0.8048377986475749, -0.7593382646825724, -0.9073841134544008, 0.17470396254334075, -0.040168197437473345, 0.007906639451200705, -0.9421679906557774, -0.05222904481429798, 0.2263011293278967], [0.13167322065510062, 0.7581999672093295, 0.30319556684111026, 0.5297976777673148, -0.10659237861951042, -0.8568523234152867, -0.33614135030124753, -0.957065317757971, 0.22230854900677208, 0.3192464730819036, 0.7566029461136973, -0.9784644961917597, 0.10822251891778145, -0.293790446558109, -0.6359212242435358, -0.5220955784956443, -0.6643640701604324, -0.1800707938457726, 0.4389579866610953, -0.6410127723374744], [-0.45524385337647555, 0.8849700880992422, -0.1026598233454751, 0.7194378646721279, -0.39350283387069734, 0.3582592286371646, 0.7532615767117151, 0.9477570548705126, -1.0020755627727782, -0.21160940069336986, -0.435512688075757, -0.56552872321127, 0.5932437183185602, -0.747660160381078, -0.0332413111444431, -0.023894211962120826, -0.4268520042645777, 0.7180707120131166, -0.018141119358405202, -0.6467043784853761], [-0.5779491602208386, -0.5998842347184292, -0.6363957311435396, -0.25576037400069224, -0.45129875223660876, 0.7825768424434376, -0.6370885503214139, 0.5915246861001474, -0.4806810019423339, 0.8936039008783871, -0.9727747736530472, 0.7786726586765401, -0.6711735805868854, 1.0014233269369457, 0.7807939590588412, -0.6305384321605418, 0.48280590368289755, 0.7145695023131595, 0.26015737337871975, 0.07602435304923755], [-0.599892133909517, -0.12261352732393896, 0.6114327163093475, 0.9821973296078658, 0.06620475349244472, -0.2609206504238738, 0.15133973721962246, -0.9665979092497555, 0.27317216699252467, -0.803490631101792, 0.4572236554433388, -0.7236017020546139, 0.14956449959251855, -0.4626177360449431, -0.7180146039664022, -0.057848316053654536, -0.688063123840829, -0.07466458176652767, -0.20907759327199005, 0.15428126062464773], [-0.7136968039205703, 0.887877277298527, 0.8748252548436835, -0.3474356031652745, -0.5624430149416574, -0.9280631092673912, 0.9830286627797988, 0.21848282935495197, 0.36615084161674594, 0.48457868082635136, 0.3689263007831327, -0.32260130939138176, 0.5376745931624922, 0.3388638843900415, -0.022035520834399795, -0.22284265515962431, -0.29819585865033177, -0.3317102083804128, -0.8663870745146249, 0.15116252937237878], [0.5829739572794919, -0.004766231251044771, 0.9643796869049901, -0.3892907617762097, -0.6328402893513513, -0.20891356782128284, -0.18369673514151497, -0.9276634698877371, -0.37941781002103203, 0.879420305605072, 0.26859204830656946, -0.7792667264473805, -0.307202891504699, 0.4528551884382972, -0.49558866983545374, -0.04462982714103912, 0.7047723433598037, 0.9334988479884474, 0.7663669573164291, -0.07655436653484642], [0.10375528821720992, -0.7492977837327123, 0.6998784822817538, -0.3851164689947564, 0.27928777723906395, -0.08396020748553976, 0.008383850742527281, 0.37712453554508435, -1.0531972458143422, -0.8790774237215373, -0.5313035753129076, 0.9219493530542897, 0.7602173653346906, -0.338505222327243, -0.8381146936384053, 0.8475659479768027, -0.3514682901506732, 0.18041092188310803, -0.8576896473647149, 0.5715104376648206]]),
            np.asarray([[0.715691489137665, 0.41899946981295777, -0.6092131082849227, 0.9881987769668009, 0.748229985261836], [0.7901844068929545, -0.4509476625363712, 0.4535324186426688, 0.7335181473850717, -0.08230319362234795], [0.8523538358587802, 0.7504352030166848, 0.21988298985739968, -0.18925562796882903, -0.5119256751399118], [-0.6215866240419745, -0.12915794821988485, -0.6603799496027586, 0.4248841361124942, -0.7709541325809852], [0.5929324456641636, 0.7683443642618362, -0.49005753586319967, -0.7913513191122187, 0.2810871861845563], [-0.5865675832676435, 0.7647310737939893, -0.663357651108854, 0.23173227314623165, 0.2740185824327737], [-0.5466360000855736, 0.45816204732961596, 0.1245197955297234, -0.5434349130088768, -0.7651208068959149], [-0.7438824230477187, -0.29538253411075754, 0.29199662097640333, -0.5806020301900993, -0.8909879849359728], [0.4182281387314814, -0.775203021723289, 0.13802947770584678, 0.40513460808106455, -0.5433016096317326], [0.3958336599253567, 0.04751108313356632, 0.7980785976043616, 0.48634328053196313, -0.23585148911149428], [-0.8221517390393434, -0.8941093394055029, 0.7582368315696931, -0.1349319774227426, 0.45907718389947505], [0.22706218145825957, -0.4647227131736265, -0.6030641120716839, -0.3509892936936805, -0.596102874047543], [0.011368591607365943, 0.45907015393862144, 0.8612901902339405, 0.45132351670822485, -0.6503701086319027], [-0.8212615899634288, 0.7640418901581255, 0.8990470520037309, 0.3295557019408551, -0.7945412746864182], [0.06570577309723687, -0.5223213747128376, 0.4021390161496157, 0.9927210039190512, 0.5720903243645715], [0.22201911572797256, -0.9737841553025569, 0.2732464473720707, 0.0111767324093682, -0.38168528472174956], [-0.627832899444636, -0.6399147777467551, -0.3783371897702594, -0.9507714200807985, -0.10930627966711183], [-0.46763686052274034, 0.439872682454752, 0.6273614670117748, -0.5229029496656862, 0.3624174278986802], [-0.7878296389389978, -0.9017923383950815, 0.5605505838594058, -0.2066247340194261, -0.21149677436029862], [0.43012972062183374, 0.6397722238361783, 0.7788349039049481, -0.7556479924149262, -0.8765972560498175]])
        ]
    checkpoint.biases = [
        np.asarray([[0.15373259781516074, 0.07123911029004128, 0.16599569592629532, 0.11973208725135155, -0.6642508283643391, 0.11581033762350412, 0.2734613716363505, 0.1474268016082944, 0.8945588743583697, 0.33570608383665956, 0.24666268826499144, -0.054254375834073894, -0.14558635079825066, 0.2849412520313415, 0.7742423016158392, -0.7186107634208897, -0.6892636063995548, 0.3750814867036457, 0.9704531770202139, 0.9593639917957467]]),
        np.asarray([[0.7946880483679604, 0.6642174474101051, -0.7954034503077687, 0.29405078147239766, 0.22431280486311683, 0.18491061064339306, 0.9169343882246925, 0.4930059274695104, 0.07021294638636824, 0.04578791196426691, -0.9207409158882481, 0.5925875023030429, -0.33636967465297596, -0.38205405515523366, 0.9801939452357494, -0.0012575155317406045, -0.2713337999965417, 0.9689380008431424, -0.3939162592846184, -0.37381755737009414]]),
        np.asarray([[-0.8630320535654441, 0.0036587664519356, 0.22977328559925478, -0.5715752238080057, 0.3976418742562199, 0.028452862647056862, -0.08925642292897389, 0.06566890349610893, 0.41686054887994595, 0.46426589745629804, -0.7035780210266932, 0.3329509517986411, -0.4902932596951805, -0.04806234882656086, -0.41684753129028784, -0.38498485125338155, -0.26148176444168764, -0.8777206721487762, -0.08415931040736138, -0.9368967420873862]]),
        np.asarray([[-0.582760801330996, 0.26354975560883165, -0.9821526155157712, 0.012372129754482018, -0.9156949163975137, 0.17913934539924364, -0.4658962611424514, 0.15252151628873523, 0.49620995943072843, 0.9136477435476402, -0.8826896893489922, -0.23985713465928438, 0.1449114994173931, -0.0212482738580628, -0.308455590140356, -0.939880560063818, -0.7616622283596322, -0.4145929048547438, 0.7916444100485094, 0.6717073095336719]]),
        np.asarray([[-0.1542278259781693, -0.8981667676915872, 0.8556698949607248, 0.6825594259062725, -0.9173947301565439, 0.06106318689574015, -0.19248205175629124, -0.1675958705394849, 0.7368012317592723, -0.20008082653069237, 0.7534753638838905, 0.8932126211623546, -0.7951664240759042, -0.9239240296880665, 0.5116564957870358, -0.02992892560639244, 0.40393681807274207, 0.056573490855025874, -0.49142306171545647, 0.05240376977465559]]),
        np.asarray([[-0.8318997265257717, -0.28332179923895295, 0.6115795368834694, -0.23771961972461336, -0.6759871410277603, -0.14700473371973555, 0.6193722321201772, -0.810922527823656, -0.5457667923530635, -0.7867735626729019, 0.6299741390715731, -0.0870098268919198, 0.6609205801694746, 0.8094362025250464, 0.6892885870621694, -0.7210251367230909, 0.6382245888088829, -0.9297862785557724, -0.47907373282624616, -0.6071418457734964]]), 
        np.asarray([[-0.4145076844904303, -0.4564786480504755, -0.3693904010468623, -0.27089731706130754, 0.6361435776112847]])
    ]
    population.append(checkpoint.make_child(checkpoint, 0.01))
    evaluation.append(0)
    agent_distances.append(0)

"""Keep track of agents and population"""
tic = time.time()
toc = time.time()
current_agent = 0
fitness_plot = []
best_distance = 0
best_agent = 0
generation_number = 0
print("Generation 0:")

"""Simulation loop"""
running = True
while running:
    #get current state, determine agents response, and apply those responses
    current_state = pogo.get_current_state()
    agent_response = population[current_agent].calculate_forward(current_state)
    pogo.apply_actions(agent_response)

    """Switch between agents. Give each agent 10 seconds before evaluating it, or if it falls over. Also keep track of when the
    generation is over and make a new one"""
    if abs(current_state[0])<1.4:
        toc = time.time()
    if time.time()-tic > 10 or time.time()-toc > 0.5:

        #determine the fitness of the agent
        agent_distances[current_agent] = current_state[2] - 300
        evaluation[current_agent] = agent_distances[current_agent] + (time.time()-tic) * 10
        print(f"Agent {current_agent} reached position {agent_distances[current_agent]} with fitness {evaluation[current_agent]}")
        if agent_distances[current_agent] > best_distance:
            best_agent = population[current_agent]
            best_distance = agent_distances[current_agent]

        #reset simulation
        current_agent += 1
        tic = time.time()
        pogo.reset_simulation()

        if current_agent == population_size:
            # find the average fitness for plotting later
            avg = sum(evaluation) / len(evaluation)
            fitness_plot.append(avg)

            #sort by the best agents
            top_indices = np.argsort(evaluation)[::-1]
            print(f"The best agent reached {agent_distances[top_indices[0]]} with fitness {evaluation[top_indices[0]]}")
            population[top_indices[0]].print_network()

            #take top 20% of population and make the next generation
            children = []
            num_top_agents = population_size//5
            if elitism:
                for i in range(num_top_agents):
                    children.append(population[top_indices[i]])
            reproduction_matrix = NeuralNetwork.generate_weighted_reproduction_matrix(num_top_agents, population_size - len(children))
            for i in range(len(reproduction_matrix)):
                for j, value in enumerate(reproduction_matrix[i]):
                    for k in range(value):
                        children.append(population[top_indices[i]].make_child(population[top_indices[j]], mutation_rate))
            generation_number += 1
            print(f'Generation {generation_number}:')
            population = children
            current_agent = 0

            #annealing
            if annealing:
                mutation_rate -= annealing_step_size
            if mutation_rate < annealing_min:
                mutation_rate = annealing_min

    # exit out of the game if x is pressed
    for event in pygame.event.get():
        if event.type == pygame.QUIT:
            running = False
    
    # Step the simulation forward
    pogo.space.step(1 / 60.0)

    # Draw the objects
    screen.fill((255, 255, 255))
    pogo.space.debug_draw(draw_options)
    pygame.display.flip()
    clock.tick(60)


pygame.quit()

print(f'The overall best agent reached {best_distance}')
best_agent.print_network()

plt.plot(fitness_plot, marker='o', linestyle='-', color='b')
plt.title('Pogostick Evolution')
plt.xlabel('Generation')
plt.ylabel('Average Fitness')
plt.legend()
plt.grid(True)
plt.show()